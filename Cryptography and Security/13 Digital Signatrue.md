# 13. Digital Signatrue

### 일반 서명과 디지털 서명의 비교

- **일반 서명** (conventional signature)
    
    : 서명한 사람으로부터 문서가 작성되었다는 것을 보장한다.
    
    - 포함관계 : 문서 내에 서명이 들어있다. (문서 자체에 서명한다)
    - 검증방법 : 내가 보관 중인 서명과 해당 서명이 같은가 (모양, 필체)로 검증
    - 관계 : 여러 문서에 서명하는 내용이 모두 같다.
    - 복제 : 복사본과 원본을 구별할 수 있다.
- **디지털 서명** (digital signature)
    
    : 송신자의 신원을 확인하기 위해서 사용한다.
    
    - 포함 관계 : 문서와 서명이 따로 존재한다.
    - 검증방법 : verification technique에 메시지와 서명을 입력하여 검증한다
    - 관계 : 메시지(문서)마다 사용한 서명이 다르다. → 다른 문서에 사용 불가
    - 복제 : 얼마든지 복사 가능 (디지털 파일이므로) → 복사 방지하려면 시간 요소를 서명에 포함한다.

### 디지털 서명 프로세스

공개키 시스템을 이용한다

![스크린샷 2022-06-13 17.52.14.png](13%20Digital%20Signatrue%20555db4d7efb641a3b6e4f0d690b3cb39/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-13_17.52.14.png)

- 송신자는 메시지와 서명(signature) 쌍을 전송한다.
- 송신자는 비밀키를 사용해 서명, 수신자는 송신자의 공개키를 이용해 서명을 검증한다.
    - S는 M과 송신자의 비밀키를 입력하여 생성된다.
    
- 공개키 암호의 두 가지 용도
    1. 암/복호 (기밀성 유지) : **수신자**의 비밀키와 공개키를 사용
    2. 디지털 서명 (저자 확인) : **송신자**의 비밀키와 공개키를 사용

- 하지만 공개키 암호시스템은 긴 메시지에 대해 속도가 느리다
    
    → 메시지 대신 (해시를 적용한) 메시지 다이제스트에 서명한다!!
    

### 디지털 서명이 보장(제공)하는 서비스

1. Message Authentication (메시지 저자 인증)
    - 개인키를 사용하기 때문에 메시지의 저자 (송신자)를 확인할 수 있다
2. Message Integrity (무결성)
    - 메시지와 디지털 서명은 1:1 관계
    
    → 메시지가 바뀌면 디지털 서명도 바뀌어야 하며, 이 때 개인키가 필요하므로 메시지가 송신자 외의 사람이 변경해서 보낸 것을 알아챌 수 있다.
    
3. Nonrepudiation (부인 방지)
    - 디지털 서명을 서명자가 부인할 수 없다. (서명에 개인키가 사용되므로)

하지만 메시지의 Confidentiality (기밀성)은 보장하지 않는다

### 디지털 서명과 기밀성을 함께 보장하는 방법

![스크린샷 2022-06-13 18.51.25.png](13%20Digital%20Signatrue%20555db4d7efb641a3b6e4f0d690b3cb39/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-13_18.51.25.png)

1. 서명
2. M, S를 함께 암호화

이 때 암호화는 대칭키 or 공개키 중에서 사용 목적에 맞는 것을 이용하면 된다

> 만약 암호화는 필요없고 서명만 필요하다면 굳이 암/복호화는 하지 않고 서명만 해도 된다
> 

## Digital Signature Scheme (디지털 서명 스키마)

---

여러 스키마가 있지만 가장 많이 사용되는 RSA 스키마만 다루도록 한다

### RSA Digital Signature Scheme

![스크린샷 2022-06-13 18.58.46.png](13%20Digital%20Signatrue%20555db4d7efb641a3b6e4f0d690b3cb39/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-13_18.58.46.png)

- 송신자 : (메시지, 개인키, n) → 서명 S를 생성 → 메시지 M과 S를 함께 전송
- 수신자 : (수신된 S, 송신자의 공개키 e, n) → 메시지 M와 같은지 확인

- RSA 공개키 암호화와 다른 점
    - 목적이 다르다 : 암호화는 메시지 기밀성을 보장 / 서명은 송신자의 신원 확인
    - 사용되는 키
        - 암호 : 수신자 공개키로 암호화 → 수신자 개인키로 복호화
        - 서명 : 송신자 개인키로 암호화 → 송신자 공개키로 복호화

![스크린샷 2022-06-13 19.04.27.png](13%20Digital%20Signatrue%20555db4d7efb641a3b6e4f0d690b3cb39/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-13_19.04.27.png)

![스크린샷 2022-06-13 19.04.32.png](13%20Digital%20Signatrue%20555db4d7efb641a3b6e4f0d690b3cb39/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-13_19.04.32.png)

- e, d는 역할이 바뀌어도 상관이 없다 (서로 곱셈역이기 때문에 공개키↔비밀키 순서는 신경쓰지 않아도 된다)
    
    (자세한 원리는 앞의 RSA를 다시 참조할 것)
    

![스크린샷 2022-06-13 19.06.06.png](13%20Digital%20Signatrue%20555db4d7efb641a3b6e4f0d690b3cb39/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-13_19.06.06.png)

### 메시지 다이제스트에 RSA 서명

RSA 암호화는 메시지의 길이가 길수록 시간이 오래 걸린다

따라서 메시지를 직접 RSA로 서명하는 것이 아닌, 해시 결과인 메시지 다이제스트에 RSA 서명을 한다

![스크린샷 2022-06-13 19.13.14.png](13%20Digital%20Signatrue%20555db4d7efb641a3b6e4f0d690b3cb39/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-13_19.13.14.png)

- 메시지 M을 직접 하지 않는다
- h(M) 결과인 메시지 다이제스트 D을 서명에 사용한다

- 강력한 hash function이 필요하다

### 다양한 서명 방법

- ElGamal 디지털 서명
- Schnorr 디지털 서명
- 디지털 서명 스탠다드 (DSS)
- 타원곡선 디지털 서명

## 디지털 서명의 변형 및 응용

---

- Time Stamped Signature
    - 시간 정보를 포함한 서명
    - replay attack 방지
        
        : 메시지를 중간에 도청해서 나중에 같은 메시지를 다시 보낸다.
        
- Blind Signatures
    - 문서 내용 (M)을 보여주지 않고 서명