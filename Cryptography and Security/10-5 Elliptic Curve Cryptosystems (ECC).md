# 10-5. Elliptic Curve Cryptosystems (ECC)

RSA, ELGamal은 좋은 비대칭 암호이지만, 키의 크기가 크다는 단점이 있다.

### Elliptic Curves over Real Numbers (실수의 타원곡선)

일반적인 타원곡선

$$
y^2+b_1xy+b_2y=x^3+a_1x^2+a_2x+a_3
$$

ECC에서 사용하고자 하는 간단한 형태의 타원곡선

$$
y^2=x^3+ax+b\space
$$

- 단, $4a^3+27b^2$≠0
    
    ⇒ 3개의 근이 생기도록 하는 조건
    

3개의 근을 가지는 타원곡선 (허근, 실근 상관 없다)

![3개의 실근을 가지는 타원곡선](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_16.43.21.png)

3개의 실근을 가지는 타원곡선

![1개의 실근과 2개의 허근을 가지는 타원곡선](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_16.43.31.png)

1개의 실근과 2개의 허근을 가지는 타원곡선

### 타원곡선을 이용한 Abelian group 정의

1. 집합 **E**를 타원곡선 상의 점들로 정의한다. (실수 x, y)
    
    ![스크린샷 2022-05-24 16.49.18.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_16.49.18.png)
    
2. 연산자 **+**를 점의 덧셈 (point addition)으로 정의한다.
3. 덧셈의 항등원(Identity) **O** : 무한의 점으로 정의한다. (=zero point, 가상의 점)
4. 덧셈의 역원 (Inverse) **-P** : 덧셈의 역원이다.
    
    ![스크린샷 2022-05-24 16.51.35.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_16.51.35.png)
    

## 타원곡선에서 Point addition 정의

---

### 1. 두 개의 다른 점 (R = P + Q)

![스크린샷 2022-05-24 16.56.00.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_16.56.00.png)

타원곡선 위의 두 점을 지나는 직선과 타원곡선의 접점을 -R로 정의

1. 두 점을 지나는 직선 l의 기울기 $\lambda$를 구한다.
    
    $\lambda=(y_2-y_1)/(x_2-x_1)$
    
2. 직선 l의 식을 세운다.
    
    $y=\lambda x+\beta$
    
3. 곡선의 식의 y에 대입한다.
4. 곡선은 $y^2=x^3+ax+b$ 또는 $(x-x_1)(x-x_2)(x-x_3)=0$ 으로 표현될 수 있다.
5. 이 때 x^2의 항만 비교한다.
    
    $-\lambda^2x^2=-(x_1+x_2+x_3)x^2$
    
6. 위의 식을 이용해서 x3을 구한다
    
    $x_3=\lambda^2-x_1-x_2$
    
7. y3를 구하기 위해서 직선 l에 점들을 대입한다.
8. y3을 구한다.
    
    $y_3=\lambda (x_1-x_3)-y_1$
    

### 2. 같은 점끼리의 덧셈 (R = P + P)

![스크린샷 2022-05-24 17.11.15.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.11.15.png)

= Doubling a point

x1 = x2이므로

$\lambda=(3x_1^2+a)/(2y_1)$

$x_3=\lambda^2-2x_1$

$y_3=\lambda (x_1-x_3)-y_1$

### 3. 역원과 덧셈 (O = P + (-P))

![스크린샷 2022-05-24 17.11.35.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.11.35.png)

역원의 정의 (x, -y)에 의해서 무한의 점 O이 된다.

⇒ O는 덧셈의 항등원이 된다. (P+O=P)

### (E, +)은 abelian group

![스크린샷 2022-05-24 17.13.19.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.13.19.png)

abelian group의 특징을 만족하는 것을 볼 수 있다.

## GF(p)에서의 Elliptic Curve

---

위에서는 실수에 대해서 EC를 다뤘다.

암호학에서 사용하기 위해서는 GF(p)에서 진행한다.

### GF(p)에서의 EC 정의

$$
y^2\space mod \space p = (x^3+ax+b)\space mod \space p
$$

- 단, $(4a^3+27b^2)mod\space p$ ≠ 0
- x, y, a, b는 $Z_p$에 속한다.

$$
E_p(a, b)
$$

GF(p)에서의 EC를 위와 같이 표현한다.

위의 식을 만족하는 점 (x, y)들로 이루어져 있다.

### Additive inverse

점의 덧셈 역원을 구할 때에 mod p에서 진행된다.

(x, y) 점에 대해서 역원은 (x, -y mod p) 이다.

ex) p = 13 → (4, 2)의 역원은 (4, 11)이다.

### Adding two points

기존 EC의 방법대로 lambda를 이용해서 구하지만,

이 또한 GF(p)에서 계산이 이루어진다.

⇒ GF(p)에서의 EC는 abelian group

### 예시

![스크린샷 2022-05-24 17.19.11.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.19.11.png)

## ECC (Elliptic Curve Cryptosystem)

---

![스크린샷 2022-05-24 17.24.11.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.24.11.png)

ElGamal과 유사하게 이루어진다.

### Generate Key (키 생성)

1. p, a, b를 선택 → $E_p(a,b)$ 결정 (GF(p)에서)
2. 점 e1 = (x1, y1)을 선택 : $E_p(a,b)$에 속한 점
3. d를 선택 : 1 ≤ d ≤ p-2
4. e2를 계산 : e2 = d x e1
    
    앞서 정의한 ‘점 덧셈’을 반복해서 계산한다.
    

- 공개키 : p, a, b, e1, e2
- 개인키 : d

### Encryption (암호화)

M : 평문 (M < p)

> 평문이 EC의 점으로 변환된 후의 상황을 가정하고 진행
> 

1. 랜점 r을 선택 : 1 ≤ r ≤ p-1
2. $C_1=r\times e_1$ 계산
3. $C_2=P+r\times e_2$ 계산

### Decryption (복호화)

$$
P=C_2-(d\times C_1)
$$

- ElGamal처럼 증명을 위한 정리가 필요 없다.
    
    ![스크린샷 2022-05-24 17.32.44.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.32.44.png)
    

### 예시

![스크린샷 2022-05-24 17.33.33.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.33.33.png)

![스크린샷 2022-05-24 17.33.48.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.33.48.png)

![스크린샷 2022-05-24 17.34.56.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.34.56.png)

### Elliptic Curve Discrete Logarithmic Problem (ECDLP)

타원곡선에서 사용하는 일방향 함수는 $e_2=d\times e_1$

- e1, d를 알고 있는 상태 → e2 계산 : 쉽다
- e1, e2를 알고 있는 상태 → d : 어렵다.

### 암호 키 크기 비교

![스크린샷 2022-05-24 17.40.42.png](10-5%20Elliptic%20Curve%20Cryptosystems%20(ECC)%2012c06a5dac674980bfc450b404be3456/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-05-24_17.40.42.png)

ECC는 RSA보다 더 작은 키 크기를 이용해서 같은 정도의 보안 효과를 낼 수 있다.

단, ECC에서는 점 연산 등의 과정이 까다로운 점이 존재한다.